<?php
$css_include = array('forms.css');
include('autohandler.php');

if( 'add' == $action ) {
  $char = new Player;
}
?>

<? if( 'delete' == $action ): ?>

<form method="post" action="<?=SITE_URL;?>/delete">
  <div>
    <p>Confirm Deletion of:</p>
    <p><?=$char->name;?>, 
      <?=$char->Race->name;?>
      <?=$char->Archetype->name;?> <?=$char->level;?></p>
  </div>
  
  <div>
    <input type="hidden" name="id" value="<?=$char->id;?>" />
    <input type="submit" value="Delete" />
  </div>
</form>

<? else: ?>

<form method="POST" action="<?=SITE_URL;?>/save">
<div class="formColumn leftColumn">
  <div class="formRow">
    <label for="character_name">Name:</label>
    <div class="field">
      <input type="text" class="text" size="20" maxlength="255"
        id="character_name" name="character_name" value="<?=$char->name;?>" />
    </div>
  </div>
  
  <div class="formRow">
    <label for="character_race">Race:</label>
    <div class="field">
      <?=Race::generateSelect(
        'character_race', 'character_race', $char->race_id);?>
    </div>
  </div>
  
  <div class="formRow">
    <label for="character_class">Class:</label>
    <div class="field">
      <?=Archetype::generateSelect(
        'character_class', 'character_class', $char->archetype_id);?>
    </div>
  </div>
  
  <div class="formRow">
    <label for="character_level">Level:</label>
    <div class="field">
      <select name="character_level" id="character_level">
      <? for($i=1;$i<=30;$i++): ?>
        <option value="<?=$i;?>"
          <?=$i==$char->level?'selected="selected"':'';?>><?=$i;?></option>
      <? endfor; ?>
      </select>
    </div>
  </div>
  
  <div class="formRow">
    <label for="attack_general">General Atk Bonus:</label>
    <div class="field">
      <input type="text" id="attack_general" name="attack_general"
        size="3" maxlength="3" value="<?=$char->attack_general;?>" />
    </div>
  </div>

  <div class="formRow">
    <label for="attack_implement">Implement Atk Bonus:</label>
    <div class="field">
      <input type="text" id="attack_implement" name="attack_implement"
        size="3" maxlength="3" value="<?=$char->attack_implement;?>" />
    </div>
  </div>

  <div class="formRow">
    <label for="attack_weapon_main">Weapon Atk Bonus:</label>
    <div class="field">
      <label>Main:</label>
      <input type="text" id="attack_weapon_main" name="attack_weapon_main"
        size="3" maxlength="3" value="<?=$char->attack_weapon_main;?>" />&nbsp;/
      <label>Off:</label>
      <input type="text" id="attack_weapon_off" name="attack_weapon_off"
        size="3" maxlength="3" value="<?=$char->attack_weapon_off;?>" />
    </div>
  </div>

  <div class="formRow">
    <label for="character_health">Max Health:</label>
    <div class="field">
      <input type="text" id="character_health" name="character_health"
        size="5" maxlength="4" value="<?=$char->health_max;?>" />
    </div>
  </div>

</div><!-- end div.leftColumn -->

<div class="formColumn rightColumn">
  <div class="formRow">
    <label for="character_str">Strength:</label>
    <div class="field">
      <input type="text" id="character_str" name="character_str"
      size="3" maxlength="2" value="<?=$char->strength;?>" />
    </div>
  </div>
  <div class="formRow">
    <label for="character_con">Constitution:</label>
    <div class="field">
      <input type="text" id="character_con" name="character_con"
      size="3" maxlength="2" value="<?=$char->constitution;?>" />
    </div>
  </div>
  <div class="formRow">
    <label for="character_dex">Dexterity:</label>
    <div class="field">
      <input type="text" id="character_dex" name="character_dex"
      size="3" maxlength="2" value="<?=$char->dexterity;?>" />
    </div>
  </div>
  <div class="formRow">
    <label for="character_int">Intelligence:</label>
    <div class="field">
      <input type="text" id="character_int" name="character_int"
      size="3" maxlength="2" value="<?=$char->intelligence;?>" />
    </div>
  </div>
  <div class="formRow">
    <label for="character_wis">Wisdom:</label>
    <div class="field">
      <input type="text" id="character_wis" name="character_wis"
      size="3" maxlength="2" value="<?=$char->wisdom;?>" />
    </div>
  </div>
  <div class="formRow">
    <label for="character_cha">Charisma:</label>
    <div class="field">
      <input type="text" id="character_cha" name="character_cha"
      size="3" maxlength="2" value="<?=$char->charisma;?>" />
    </div>
  </div>
  
  <div class="formRow">
    <label for="character_surges">Surges/Day:</label>
    <div class="field">
      <input type="text" id="character_surges" name="character_surges"
        size="4" maxlength="3" value="<?=$char->surges_max;?>" />
    </div>
  </div>

  <div class="formRow">
    <label for="character_surge_value">Surge Value:</label>
    <div class="field">
      <input type="text" id="character_surge_value" name="character_surge_value"
        size="4" maxlength="3" value="<?=$char->surge_value;?>" />
    </div>
  </div>
</div><!-- end div.rightColumn -->

<div class="clear" />
<div id="SubmitButton" class="clear">
  <? if( $char->exists() ): ?>
  <input type="hidden" name="id" value="<?=$char->id;?>" />
  <? endif; ?>
  <input type="submit" value="Submit" />
</div>
</form>
<? endif; ?>

<?php include('footer.php'); ?>
