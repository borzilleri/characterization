<?php
$form_key = 'skill_edit_'.(empty($_REQUEST['p_id'])?0:$_REQUEST['p_id']);
$css_include = array('forms.css');
$js_include = array('skills.js');
include('autohandler.php');

if( !$char || !$char->exists() ) {
	loadPage('/');
}

$skill = new Skill();
?>

<form method="post" action="<?=SITE_URL;?>/<?=$char->id;?>/skills/save">
<input type="hidden" name="s_id" id="s_id" value="" />
<table id="SkillTable">
	<thead>
		<tr class="row0">
			<td colspan="2">&nbsp;</td>
			<th><label for="name">Skill Name</label></th>
			<th><label for="ability">Ability</label></th>
			<th><label for="bonus">Misc</label></th>
			<th colspan="2"><label for="trained">Train</label></th>
		</tr>
	</thead>
	<tbody>
		<tr class="row0" id="blankFormRow">
			<td class="icon"><input type="image" class="icon" alt="submit"
				src="<?=MEDIA_URL;?>/images/icon_medical.png" /></td>
			<td class="skillName" colspan="2">
				<input type="text" id="name" name="name" size="20" maxlength="255" 
					value=""/>
			</td>
			<td class="skillAbility">
				<select id="ability" name="ability">
					<option value="Str">Str</option>
					<option value="Con">Con</option>
					<option value="Dex">Dex</option>
					<option value="Int">Int</option>
					<option value="Wis">Wis</option>
					<option value="Cha">Cha</option>
				</select>
			</td>
			<td class="skillBonus">
				<input type="text" id="bonus" name="bonus" size="2" maxlength="3" />
			</td>
			<td class="skillTrained">
				<input type="checkbox" id="trained" name="trained" value="1" /></td>
			<td>&nbsp;</td>
		</tr>
				
	<? $i=1; foreach($char->Skills as $s): ?>
		<tr id="s<?=$s->id;?>" class="row<?=$i;$i=($i+1)%2;?>">
			<td class="icon">
				<a href="javascript:;" class="skillEditLink" id="e<?=$s->id;?>">
				<img src="<?=MEDIA_URL;?>/images/icon_gear2.png" 
					alt="edit" class="icon" /></a>
			</td>
			<td class="totalBonus"><?=$s->getMod();?></td>
			<td class="skillName"><?=$s->name;?></td>
			<td class="skillAbility">
				<span class="skillAbilityName"><?=$s->ability;?></span>
				(<?=$char->getMod($s->ability,1,1);?>)
			</td>
			<td class="skillBonus"><?=$s->bonus?$s->bonus:'';?></td>
			<td class="skillTrained"><?=$s->trained?Skill::TRAINED_BONUS:'';?></td>
			<td class="icon"><input type="image" class="icon" name="submit"
				value="delete_<?=$s->id;?>" 
				src="<?=MEDIA_URL;?>/images/icon_skull-n-crossbones.png"/>
			</td>
		</tr>
	<? endforeach; ?>
	</tbody>
</table>
</form>

<?php include('footer.php'); ?>